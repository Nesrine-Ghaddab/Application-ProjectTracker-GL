{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mon Profil</title>

  <link rel="icon" href="{% static 'base_tailwind/favicon.ico' %}">
  <link href="{% static 'base_tailwind/style.css' %}" rel="stylesheet">
</head>

<body x-data="{ page: 'profile', 'darkMode': true, 'stickyMenu': false, 'navigationOpen': false, 'scrollTop': false }"
  x-init="
      darkMode = JSON.parse(localStorage.getItem('darkMode'));
      $watch('darkMode', value => localStorage.setItem('darkMode', JSON.stringify(value)))"
  :class="{'b eh': darkMode === true}">



  <!-- ===== Header Start ===== -->
  <header class="g s r vd ya cj" 
        :class="{ 'hh sm _k dj bl ll' : stickyMenu }"
        @scroll.window="stickyMenu = (window.pageYOffset > 20)">

    <div class="bb ze ki xn 2xl:ud-px-0 oo wf yf i">
        <div class="vd to/4 tc wf yf">

            <!-- Logo -->
            <a href="{% url 'home' %}">
                <img class="om" src="{% static 'base_tailwind/images/logo-light.svg' %}" alt="Logo Light">
                <img class="xc nm" src="{% static 'base_tailwind/images/logo-dark.svg' %}" alt="Logo Dark">
            </a>

            <!-- Burger menu -->
            <button class="po rc" @click="navigationOpen = !navigationOpen">
                <span class="rc i pf re pd">
                    <span class="du-block h q vd yc">
                        <span class="rc i r s eh um tg te rd eb ml jl dl" :class="{ 'ue el': !navigationOpen }"></span>
                        <span class="rc i r s eh um tg te rd eb ml jl fl" :class="{ 'ue qr': !navigationOpen }"></span>
                        <span class="rc i r s eh um tg te rd eb ml jl gl" :class="{ 'ue hl': !navigationOpen }"></span>
                    </span>
                </span>
            </button>

        </div>

        <!-- NAVIGATION -->
        <div class="vd wo/4 sd qo f ho oo wf yf"
             :class="{ 'd hh rm sr td ud qg ug jc yh': navigationOpen }">

            <nav>
                <ul class="tc _o sf yo cg ep">

                    <li>
                        <a href="{% url 'home' %}" class="xl">Dashboard</a>
                    </li>

                    <!-- Pages Menu -->
                    <li class="c i" x-data="{ dropdownPages: false }">
                        <a href="#!" class="xl tc wf yf bg"
                           @click.prevent="dropdownPages = !dropdownPages">
                           Pages
                           <svg :class="{ 'wh': dropdownPages }" class="th mm we fd pf" viewBox="0 0 512 512">
                               <path d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 
                               0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 
                               0s-12.5 32.8 0 45.3l192 192z"/>
                           </svg>
                        </a>

                        <ul class="a" :class="{ 'tc': dropdownPages }">
                            <li><a href="{% url 'study:home' %}" class="xl">Sessions</a></li>
                            <li><a href="#" class="xl">Projects & tasks</a></li>
                            <li><a href="#" class="xl">Agenda</a></li>
                            <li><a href="#" class="xl">Meetings</a></li>
                            <li><a href="#" class="xl">Habits & notes</a></li>
                        </ul>
                    </li>

                    <li><a href="#support" class="xl">Support</a></li>

                    {% if user.is_authenticated %}
                    <!-- USER MENU -->
                    <li class="c i" x-data="{ dropdownUser: false }">
                        <a href="#!" class="xl tc wf yf bg"
                           @click.prevent="dropdownUser = !dropdownUser">
                            {{ user.nom }} {{ user.prenom }}
                            <svg :class="{ 'wh': dropdownUser }" class="th mm we fd pf" viewBox="0 0 512 512">
                                <path d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 
                                12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 
                                0s-12.5 32.8 0 45.3l192 192z"/>
                            </svg>
                        </a>

                        <ul class="a" :class="{ 'tc': dropdownUser }">
                            <li><a href="{% url 'profile' %}" class="xl">My Profile</a></li>
                            <li><a href="{% url 'edit_profile' %}" class="xl">Edit Profile</a></li>
                            <li><a href="{% url 'logout' %}" class="xl text-red-500">Logout</a></li>
                        </ul>
                    </li>
                    {% endif %}

                </ul>
            </nav>

            <!-- RIGHT SIDE BUTTONS -->
            <div class="tc wf ig pb no">

                <!-- DARK MODE -->
                <div class="pc h io pa ra" :class="navigationOpen ? '!-ud-visible' : 'd'">
                    <label class="rc ab i">
                        <input type="checkbox" @change="darkMode = !darkMode"
                               class="pf vd yc uk h r za ab"/>

                        <svg class="th om" width="25" height="25" viewBox="0 0 25 25">
                            <path d="... (sun icon path) ..." />
                        </svg>

                        <img class="xc nm" src="{% static 'base_tailwind/images/icon-moon.svg' %}" alt="Moon"/>
                    </label>
                </div>

                <!-- BUTTONS : LOGIN / SIGN UP / LOGOUT -->
                {% if user.is_authenticated %}
                    <a href="{% url 'logout' %}" class="ek pk xl text-red-500">Logout</a>
                {% else %}
                    <a href="{% url 'login' %}" class="ek pk xl">Sign In</a>
                    <a href="{% url 'register' %}" class="lk gh dk rg tc wf xf _l gi hi">Sign Up</a>
                {% endif %}
            </div>

        </div>
    </div>
</header>

  <!-- ===== Header End ===== -->



  <!-- ===== Profile Section ===== -->
  <section class="i pg fh rm ki xn vq gj qp gr hj rp hr">

    <!-- Background Shapes -->
    <img src="{% static 'base_tailwind/images/shape-06.svg' %}" alt="Shape" class="h j k" />
    <img src="{% static 'base_tailwind/images/shape-03.svg' %}" alt="Shape" class="h l m" />
    <img src="{% static 'base_tailwind/images/shape-17.svg' %}" alt="Shape" class="h n o" />
    <img src="{% static 'base_tailwind/images/shape-18.svg' %}" alt="Shape" class="h p q" />

    <div class="animate_top bb af i va sg hh sm vk xm yi _n jp hi ao kp">

      <div class="rj text-center">
        <h2 class="ek ck kk wm xb">Mon Profil</h2>
      </div>

      <div class="text-center mt-6">
        {% if user.photo %}
    <img src="{{ user.photo.url }}"
         class="w-32 h-32 rounded-full mx-auto shadow-lg border-4 border-white"
         alt="Photo de profil">
{% else %}
    <img src="{% static 'base_tailwind/images/default-avatar.png' %}"
         class="w-32 h-32 rounded-full mx-auto shadow-lg border-4 border-white"
         alt="Photo par défaut">
{% endif %}


        <h2 class="text-3xl font-bold mt-4">{{ user.nom }} {{ user.prenom }}</h2>
        <p class="text-gray-500 text-lg">{{ user.email }}</p>
      </div>

      <div class="mt-6 p-6 bg-white shadow-lg rounded-xl">
        <p class="text-gray-700"><strong>Nom :</strong> {{ user.nom }}</p>
        <p class="text-gray-700"><strong>Prénom :</strong> {{ user.prenom }}</p>
        <p class="text-gray-700"><strong>Email :</strong> {{ user.email }}</p>
        <p class="text-gray-700"><strong>Rôle :</strong> {{ user.role|capfirst }}</p>
        <p class="text-gray-700"><strong>Date inscription :</strong> {{ user.dateInscription|date:"d M Y" }}</p>
      </div>

      <div class="mt-8 text-center">
        <a href="{% url 'edit_profile' %}"
           class="vd rj ek rc rg gh lk ml il _l gi hi">
          Modifier Profil
        </a>
      </div>

    </div>
  </section>



  <!-- ===== Footer Start ===== -->
  <footer>
    <div class="bb ze ki xn 2xl:ud-px-0">
      <div class="bh ch pm tc uf sf yo wf xf ap cg fp bj">
        <p class="animate_top">&copy; 2025 Base - Profile Page. All rights reserved.</p>
      </div>
    </div>
  </footer>
  <!-- ===== Footer End ===== -->

  <script defer src="{% static 'base_tailwind/bundle.js' %}"></script>

</body>

</html>
